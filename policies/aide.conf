@@define USER warren

# Database locations
database_in=file:/opt/local/var/lib/aide/aide.db
database_out=file:/opt/local/var/lib/aide/aide.db.new

# Uncompressed for faster reads
gzip_dbout=no

# Logging
log_level=warning
report_url=file:/opt/local/var/log/aide/aide.log
report_url=stdout
report_level=changed_attributes
report_grouped=true
report_summarize_changes=true

# Performance - use half of available CPU cores
num_workers=50%

# =============================================================================
# GROUPS
# =============================================================================

Checksums = sha256

# Full integrity check
Full = p+u+g+ftype+n+i+s+m+c+Checksums

# For config files
ConfigFile = p+u+g+ftype+s+m+c+Checksums

# Directory structure only
DirOnly = p+u+g+ftype+n+i

# =============================================================================
# PERSISTENCE MECHANISMS - PRIMARY
# =============================================================================

# LaunchDaemons/Agents (most common persistence)
/Library/LaunchDaemons Full
/Library/LaunchAgents Full
/Users/@@{USER}/Library/LaunchAgents Full

# Login items
/Library/Preferences/com.apple.loginwindow.plist ConfigFile
/Users/@@{USER}/Library/Preferences/com.apple.loginitems.plist ConfigFile

# Privileged helper tools
/Library/PrivilegedHelperTools Full

# =============================================================================
# PERSISTENCE MECHANISMS - SECONDARY
# =============================================================================

# Authorization plugins (can intercept login)
/Library/Security Full

# Directory services plugins
/Library/DirectoryServices Full

# Scripting additions (AppleScript injection)
/Library/ScriptingAdditions Full

# Spotlight importers (code execution on file indexing)
/Library/Spotlight Full

# Legacy startup items
/Library/StartupItems Full

# Input managers (deprecated but functional)
/Library/InputManagers Full

# User Automator services
/Users/@@{USER}/Library/Services Full
/Users/@@{USER}/Library/Workflows Full

# Keyboard services / input methods
/Library/Input\ Methods Full
/Users/@@{USER}/Library/Input\ Methods Full
/Library/Keyboard\ Layouts Full
/Users/@@{USER}/Library/Keyboard\ Layouts Full

# =============================================================================
# APPLICATIONS
# =============================================================================

/Applications Full

# Exclude noisy metadata
!/Applications/.DS_Store
!/Applications/.localized

# =============================================================================
# MACPORTS BINARIES
# =============================================================================

/opt/local/bin Full
/opt/local/sbin Full
/opt/local/libexec Full

# =============================================================================
# HOMEBREW (uncomment if installed)
# =============================================================================

# Intel Mac:
# /usr/local/bin Full
# /usr/local/sbin Full

# Apple Silicon:
# /opt/homebrew/bin Full
# /opt/homebrew/sbin Full

# =============================================================================
# SYSTEM CONFIGURATION
# =============================================================================

# Shell configs
/Users/@@{USER}/.zshrc ConfigFile
/Users/@@{USER}/.zprofile ConfigFile
/Users/@@{USER}/.zshenv ConfigFile
/Users/@@{USER}/.zlogout ConfigFile
/Users/@@{USER}/.bashrc ConfigFile
/Users/@@{USER}/.bash_profile ConfigFile
/Users/@@{USER}/.bash_logout ConfigFile
/Users/@@{USER}/.profile ConfigFile
/Users/@@{USER}/.inputrc ConfigFile

# PATH injection
/private/etc/paths ConfigFile
/private/etc/paths.d Full

# Shell list
/private/etc/shells ConfigFile

# SSH configuration
/Users/@@{USER}/.ssh/config ConfigFile
/Users/@@{USER}/.ssh/authorized_keys ConfigFile
/private/etc/ssh Full

# sudoers
/private/etc/sudoers ConfigFile
/private/etc/sudoers.d Full

# PAM configuration
/private/etc/pam.d Full

# Periodic scripts (cron-like)
/private/etc/periodic Full

# Cron
/private/var/at Full
/usr/lib/cron Full

# DNS
/private/etc/hosts ConfigFile
/private/etc/resolv.conf ConfigFile

# Syslog config
/private/etc/syslog.conf ConfigFile
/private/etc/newsyslog.conf ConfigFile
/private/etc/newsyslog.d Full
/private/etc/asl.conf ConfigFile
/private/etc/asl Full

# =============================================================================
# SECURITY TOOLS CONFIG
# =============================================================================

# Santa (if installed)
/var/db/santa Full

# AIDE itself
/opt/local/etc/aide Full

# =============================================================================
# LIBRARY - HIGH-VALUE TARGETS
# =============================================================================

# Application support - structure only
/Library/Application\ Support$ DirOnly

# System extensions
/Library/SystemExtensions Full
/Library/Extensions Full

# Frameworks
/Library/Frameworks Full

# Screen savers (code execution vector)
/Library/Screen\ Savers Full
/Users/@@{USER}/Library/Screen\ Savers Full

# =============================================================================
# EXCLUSIONS
# =============================================================================

# Caches and temp
!/Library/Caches
!/Users/@@{USER}/Library/Caches
!/private/var/folders
!/private/tmp
!/private/var/tmp

# Containers (TCC protected, causes errors)
!/Users/@@{USER}/Library/Containers

# Logs
!/Library/Logs
!/Users/@@{USER}/Library/Logs
!/Library/Application\ Support/CrashReporter
